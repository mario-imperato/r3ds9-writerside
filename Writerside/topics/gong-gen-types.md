# gen: sotto comando types

```
Usage:
  tpm-gong-schematics-cli gen types [flags]

Flags:
  -h, --help            help for types
  -n, --name string     name of the entity to create
  -p, --path string     full path of the item. The path is relative from the angular.json folder (and the command should be executed inside that path) (default ".")
  -s, --schema string   path to the schema file containing defs (default "./schema.yml")
  -k, --with-bak        the current artifacts if present will be backed-up and a diff file produced
  -f, --with-flat       if set to true the stuff is created in a subfolder named after the name of the object, if not, it is created into the parent
  -t, --with-format     the go code will be formatted
  -w, --with-new        if the current artifacts is present the new one will be written to a .new file and a diff file produced
```

Questo comando utilizza le definizioni morphia referenziate all'interno dello schema.yml.
morphia &egrave; un altro tool di generazione che a partire da delle definizioni yaml di collection mongo-db produce
codice golang per l'interazione con le collection.
Il sottocomando types lavora sulla stessa configurazione ma produce un semplice output in formato typescript.

| parametro | note                                                                                                                                                                          |
|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| schema    | path del file schema.yml che contiene la definizione che si desidera                                                                                                          |
| name      | nome dell'entit&agrave; che si vuole generare                                                                                                                                 |
| path      | path di generazione dell'artefatto typescript; si tenga conto che questo path &egrave; la root del path in quanto l'effettivo path dipende dal package definitio nello schema |


```shell
tpm-gong-schematics-cli gen types \
  --schema ../../../r3ds9-2/r3ds9-mongodb/store/schemas/apicore/schema.yml \
  --name User \
  --path ./
```

nel caso in cui la definizione nello schema avesse una forma simile (riproduzione parziale)

```yaml
- file-name: ./user.yml
  document: true
  package: github.com/mario-imperato/r3ds9-mongodb/store/r3ds9-apicore/user
```

con un file user.yml della forma (nuovamente parziale)

```yaml
name: User
attributes:
- name: oId
  type: object-id
  options: with-filter
  tags:
    - name: json
      value: _id,omitempty
    - name: bson
      value: _id,omitempty
    - name: yaml
      value: _id,omitempty
- name: nickname
  type: string
  options: with-filter
- name: objType
  type: string
- name: firstname
  type: string
- name: lastname
  type: string
- name: email
  type: string
- name: password
  type: string
- name: roles
  type: array
  item:
    type: struct
    struct-ref:
      name: UserRole
- name: sysInfo
  struct-ref:
    name: SysInfo
  type: struct
- name: profilePicture
  struct-ref:
    name: FileReference
  type: struct
```

si otterrebbe un output del tipo seguente all'interno del path `src/app/store/r3ds9-apicore/user/user.ts`
all'interno della cartella del progetto Angular.

```ts
//
// Generated by tpm-gong-schematics. GPA Gruppo Progetti Avanzati s.r.l. 2024
//
import {UserRole} from "../../commons/user-role"
import {SysInfo} from "../../commons/sys-info"
import {FileReference} from "../../commons/file-reference"

// @tpm-schematics:start-region("top-file-section")
// @tpm-schematics:end-region("top-file-section")

export interface User {
_id: string
nickname: string
objType: string
firstname: string
lastname: string
email: string
password: string
roles: UserRole[]
sysInfo: SysInfo
profilePicture: FileReference

// @tpm-schematics:start-region("interface-section")
// @tpm-schematics:end-region("interface-section")
}

// @tpm-schematics:start-region("bottom-file-section")
// @tpm-schematics:end-region("bottom-file-section")
```
